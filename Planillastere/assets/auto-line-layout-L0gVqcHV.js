const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-DL1KN6Od.js","./index-CkDDnH0o.css"])))=>i.map(i=>d[i]);
import{_ as I}from"./index-DL1KN6Od.js";function T(){return 1}function R(s,r){if(!s||s<=0)return 0;const n=Math.round(s*(isFinite(r)?r:1));return Math.max(0,n)}const u={marginX:0,marginY:0,stationSpacingX:820,operatorSpacingY:220,bufferOffsetX:420,bufferWidth:280,getBufferY:(s,r,n)=>r+(s-1)*n/2},z=[{id:"station-00",type:"material_preparation",name:"PreparaciÃ³n"},{id:"station-01",type:"soldering",name:"Soldado"},{id:"station-02",type:"chinese_tester",name:"Tester Chino"},{id:"station-03",type:"inprocess_test",name:"Test IPT"},{id:"station-04",type:"transparent_termo",name:"Termo Transparente"},{id:"station-05",type:"filament",name:"Filamento"},{id:"station-06",type:"white_termo",name:"Blanco"},{id:"station-07",type:"burning",name:"Quemado"},{id:"station-08",type:"cushions",name:"Almohadillas"},{id:"station-09",type:"rubber",name:"Engomado"},{id:"station-10",type:"final_functionality_test",name:"Test Final"},{id:"station-11",type:"packaging",name:"Empaque"}];function X(s){return{material_preparation:"preparacion",soldering:"soldadura",chinese_tester:"testing",inprocess_test:"testing",transparent_termo:"termo",filament:"ensamblaje",white_termo:"termo",burning:"ensamblaje",cushions:"ensamblaje",rubber:"ensamblaje",final_functionality_test:"testing",packaging:"empaque"}[s]??"todos"}async function O(s,r,n){n||(n=(await I(()=>import("./index-DL1KN6Od.js").then(i=>i.g),__vite__mapDeps([0,1]),import.meta.url)).loadGlobalConfig());const c=[],f=[],P=T();let y=0,g=0,l=u.marginX;const S=u.marginY,m=[];z.forEach(({id:e,type:i})=>{const o=s.stations.find(d=>d.stationId===e),t=n.stations[i];if(!t){console.warn(`ConfiguraciÃ³n no encontrada para: ${i}`);return}let p=o?.operarios??t.defaultOperators;p=Math.max(t.minOperators,Math.min(t.maxOperators,p));const a=R(p,P);if(a>0){const d=u.getBufferY(a,S,u.operatorSpacingY);m.push({stationType:i,stationConfig:t,operatorCount:a,moduleIds:[],centerY:d,startX:l}),g+=a,l+=u.stationSpacingX}}),l=u.marginX,m.forEach((e,i)=>{const{stationType:o,stationConfig:t,operatorCount:p}=e;for(let a=0;a<p;a++){const d=Date.now()+y,_=`${o}-op${a+1}-${d}`,h={id:_,name:`${t.name} #${a+1}`,category:X(o),position:{x:l,y:S+a*u.operatorSpacingY},status:"inactivo",connections:[],description:t.name,icon:"ðŸ‘·",operatorsCount:1,timePerUnit:t.baseCycleTime??0,unitsPerHour:t.baseUPH??0,preparationTime:0,velocity:t.baseUPH?Math.round(t.baseUPH/60):0,failureRate:n.simulation?.defectRate??0,actualPerformance:100,totalProcessed:0,efficiency:Math.max(50,Math.min(100,(n.production?.targetEfficiency??95)+Math.random()*5-2.5)),isTemplate:!1,operatorId:`OP-${o}-${a+1}`,stationType:o,throughput:t.baseUPH,hasInput:!["material_preparation"].includes(o),hasOutput:!["packaging"].includes(o),hasRework:["chinese_tester","inprocess_test","final_functionality_test"].includes(o),rollSize:t.batchSize??void 0,receivedRolls:0,sentRolls:0};h.rollSize&&h.rollSize>0?h.cadenceAccumulator=Math.random()*h.rollSize:h.cadenceAccumulator=0,c.push(h),e.moduleIds.push(_),y++}l+=u.stationSpacingX}),m.forEach((e,i)=>{if(!(i===m.length-1)){const t=m[i+1],p=Date.now()+y+5e4+i,a=`buffer-${e.stationType}-to-${t.stationType}-${p}`,d=e.startX+u.bufferOffsetX,_=e.centerY,C={id:a,name:"Buffer",category:"todos",position:{x:d,y:_},status:"activo",connections:[],description:"Buffer intermedio",icon:"ðŸ“¦",operatorsCount:0,timePerUnit:0,unitsPerHour:0,preparationTime:0,velocity:0,failureRate:0,actualPerformance:100,totalProcessed:0,efficiency:100,isTemplate:!1,operatorId:`BUFFER-${i}`,stationType:"buffer",throughput:0,hasInput:!0,hasOutput:!0,hasRework:!1,rollSize:e.stationConfig.batchSize??10,receivedRolls:0,sentRolls:0,isBuffer:!0,bufferCapacity:n.buffer?.defaultCapacity??1e3,currentBuffer:0,bufferStatus:"normal"};c.push(C),y++,e.moduleIds.forEach(b=>{f.push({id:`conn-${b}-to-${a}`,fromModuleId:b,toModuleId:a,connectionType:"normal",flowRate:e.stationConfig.baseUPH,bufferSize:n.buffer?.defaultCapacity??1e3,durability:100,isBottleneck:!1,rollSize:e.stationConfig.batchSize??void 0,currentRolls:0,accumulatedUnits:0,rollsPerHour:e.stationConfig.batchSize?Math.floor(e.stationConfig.baseUPH/e.stationConfig.batchSize):0})}),t.moduleIds.forEach(b=>{f.push({id:`conn-${a}-to-${b}`,fromModuleId:a,toModuleId:b,connectionType:"normal",flowRate:t.stationConfig.baseUPH,bufferSize:n.buffer?.defaultCapacity??1e3,durability:100,isBottleneck:!1,rollSize:t.stationConfig.batchSize??void 0,currentRolls:0,accumulatedUnits:0,rollsPerHour:t.stationConfig.batchSize?Math.floor(t.stationConfig.baseUPH/t.stationConfig.batchSize):0})})}});const M=c.filter(e=>e.isBuffer).length;return{modules:c,connections:f,totalOperators:g,bufferCount:M}}function $(s){if(s.length===0)return{centerX:0,centerY:0,suggestedScale:1};let r=1/0,n=-1/0,c=1/0,f=-1/0;s.forEach(o=>{r=Math.min(r,o.position.x),n=Math.max(n,o.position.x),c=Math.min(c,o.position.y),f=Math.max(f,o.position.y)});const P=(r+n)/2,y=(c+f)/2,g=n-r+400,l=f-c+400,S=1400,m=800,M=S/g,e=m/l,i=Math.min(M,e,1);return{centerX:P,centerY:y,suggestedScale:Math.max(.3,i)}}export{$ as calculateOptimalViewport,O as generateProductionLineLayout};
